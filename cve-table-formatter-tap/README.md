# CVE list formatter

This script takes in an HTML table of CVEs (without indentations) and outputs a table that
meets the TAP release notes standard (orders components in alphabetical order,
creates expandable sections for the CVE lists, and creates links for each CVE).

## Instructions

1. Pull any updates to the `cve_table_formatter.sh` script to your local machine.

    ```
    cd ~/workspace/docs-utility-scripts
    git pull
    ```

1. Use a Markdown to HTML converter tool (such as https://codebeautify.org/markdown-to-html)
   to convert to HTML the Markdown table of CVEs that the engineers PR'd.

    Example table after conversion to HTML:

    ```
    <table>
    <thead>
    <tr>
    <th>Package name</th>
    <th>Vulnerabilities resolved</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>PACKAGE-B.tanzu.vmware.com</td>
    <td><ul>
    <li>GHSA-xxxx-xxxx-xxxx</li>
    <li>CVE-2023-12345</li>
    </ul></td>
    </tr>
    <td>PACKAGE-A.tanzu.vmware.com</td>
    <td><ul>
    <li>GHSA-xxxx-xxxx-xxxx</li>
    <li>CVE-2023-12345</li>
    </ul></td>
    </tr>
    </tbody>
    </table>
    ```

1. Copy the HTML table into the file `cve_table_input.txt`, which is in the same
   directory as the `cve_table_formatter.sh` script.

1. Save the `cve_table_input.txt` file.

1. In the directory where the `cve_table_formatter.sh` script is located, run the script:

    ```
    cd ~/workspace/docs-utility-scripts/cve_table_formatter-tap
    bash cve_table_formatter.sh
    ```

    The script creates an output file called `cve_table_output.txt`.

1. Open the `cve_table_output.txt` file. This file contains the HTML table of CVEs
   formatted to meet the TAP release notes standard. Copy this output and paste into the release notes.

   Example output contents:

    ```
    <table>
    <thead>
    <tr>
    <th>Package name</th>
    <th>Vulnerabilities resolved</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>PACKAGE-A.tanzu.vmware.com</td>
    <td><details><summary>Expand to see the list</summary><ul>
    <li><a href="https://github.com/advisories/GHSA-xxxx-xxxx-xxxx">GHSA-xxxx-xxxx-xxxx</a></li>
    <li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-12345">CVE-2023-12345</a></li>
    </ul></details></td>
    </tr>
    <tr>
    <td>PACKAGE-B.tanzu.vmware.com</td>
    <td><details><summary>Expand to see the list</summary><ul>
    <li><a href="https://github.com/advisories/GHSA-xxxx-xxxx-xxxx">GHSA-xxxx-xxxx-xxxx</a></li>
    <li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-12345">CVE-2023-12345</a></li>
    </ul></details></td>
    </tr>
    </tbody>
    </table>
    ```
